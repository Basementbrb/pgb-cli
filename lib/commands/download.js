const has=require('./helpers/validators'),format=require('./helpers/formatters'),Progress=require('../util/progress'),complete=require('./helpers/complete');module.exports=()=>{let a;has.args(2),has.signed_in();let b=has.id(pgb.opts.commands[1]),c=has.platform(pgb.opts.commands[2],!0),d=pgb.opts.commands[3]||'.',e=(b)=>{a||(a=new Progress('downloading ',b.size,40),a.start()),a.update(b.pos,`${format.size(b.pos)} / ${format.size(b.size)}`)};return process.once('api/connect',(a)=>{pgb.opts.stdout||200===a.statusCode&&(pgb.print(`downloading to ${a.path}`),process.on('api/read',e))}),pgb.opts.stdout&&(d=process.stdout),pgb.api.downloadApp(b,c,d).then(()=>{a&&a.stop()})},module.exports.completion=complete.appAndPlatform;