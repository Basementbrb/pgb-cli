const EasyTable=require('easy-utf8-table'),format=require('./helpers/formatters'),has=require('./helpers/validators'),toTitleCase=a=>a.replace(/\w\S*/g,a=>a.charAt(0).toUpperCase()+a.substr(1).toLowerCase()),print=a=>{let b=Math.max(process.stdout.columns-80,0),c='',d=[],e=a=>(a=format.status(a),EasyTable.rightPadder(' ')(a,8)),f=new EasyTable;a.apps.forEach(function(a){d.push(a.id),f.cell(pgb.colours.header('App Id '),a.id.toString()),f.cell(pgb.colours.header('Title'),format.trunc(a.title,15+b)),1===pgb.opts.commands.length&&(f.cell(pgb.colours.header('Version'),format.trunc(a.version||'',11)),f.cell(pgb.colours.header('iOS'),a.status.ios,e),f.cell(pgb.colours.header('Android'),a.status.android,e),f.cell(pgb.colours.header('Windows'),a.status.winphone,e),f.cell(pgb.colours.header('Last Built'),a.last_build?format.date(a.last_build):''));for(let b,c=1;c<pgb.opts.commands.length;c++)b=a[pgb.opts.commands[c]],b||(b=''),f.cell(pgb.colours.header(toTitleCase(pgb.opts.commands[c].replace('_',' '))),'string'==typeof b?b:require('util').inspect(b).replace('\n',''));f.newRow()}),c=c.concat('\n'),c=''===f.toString().trim()?'\nno apps\n':c.concat(f.toString()),pgb.print({pretty:c,json:a,bare:d.join('\n')})};module.exports=()=>(has.signed_in(),pgb.api.getApps().then(print));