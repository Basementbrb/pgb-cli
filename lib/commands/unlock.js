const has=require('./helpers/validators'),unlockKey=require('./helpers/unlock-key'),complete=require('./helpers/complete');module.exports=()=>{has.args(2),has.signed_in();let a=has.key_platform(pgb.opts.commands[1],!0),b=has.id(pgb.opts.commands[2]);return'winphone'===a?Promise.reject(new Error('"winphone" signing keys are not locked')):unlockKey(a).then(c=>pgb.api.updateKey(a,b,{data:c})).then(c=>pgb.print({pretty:`${pgb.colours.bold(a)} key ${pgb.colours.bold(b)} unlocked`,json:c,bare:c.id}))},module.exports.completion=()=>complete.key();